<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.application.audit.module.works.dao.WorksBatisDAO">

    <select id="allWithScoreSearch" parameterType="WorksBO" resultType="WorksListBO">
        select
        w.id as id,
        w.create_id as createId,
        w.create_name as createName,
        w.create_time as createTime,
        w.file_url as fileUrl,
        w.works_desc as worksDesc,
        w.works_name as worksName,
        s.score as score,
        w.batch as batch,
        w.status as status
        from t_works w
        left join t_user u on w.create_id = u.id
        left join t_score s on s.works_id  = w.id
        <where>
            <if test="worksName != null and worksName != ''">
                and w.works_name like "%${worksName}%"
            </if>
            <if test="createName != null and createName != ''">
                and w.create_name like "%${createName}%"
            </if>
        </where>
        order by w.create_time desc
    </select>

    <select id="getCountWorks" resultType="CountWorksBO">
        SELECT count(*) as value,`type` as type FROM `t_works` group by type
    </select>
</mapper>
